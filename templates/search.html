{% extends "base.html" %}

{% block title %}–ü–æ–∏—Å–∫ - PivooReddit{% endblock %}

{% block content %}
<div class="search-container">
    <h1>–ü–æ–∏—Å–∫</h1>
    
    <form method="POST" class="form search-form-page">
        {{ form.hidden_tag() }}
        
        <div class="search-input-group">
            {{ form.q(class="form-control", placeholder="–ß—Ç–æ –≤—ã –∏—â–µ—Ç–µ?") }}
            {{ form.search_type(class="form-control") }}
            {{ form.submit(class="btn btn-primary") }}
        </div>
    </form>
    
    {% if results is not none %}
        <div class="search-results">
            {% if results %}
                <h2>
                    –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞
                    {% if form.search_type.data == 'posts' %}
                        –ø–æ –ø–æ—Å—Ç–∞–º
                    {% elif form.search_type.data == 'users' %}
                        –ø–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º
                    {% else %}
                        –ø–æ —Å–æ–æ–±—â–µ—Å—Ç–≤–∞–º
                    {% endif %}
                </h2>
                
                {% if form.search_type.data == 'posts' %}
                    <div class="posts-list">
                        {% for post in results %}
                            {% include "posts/post_item.html" %}
                        {% endfor %}
                    </div>
                
                {% elif form.search_type.data == 'users' %}
                    <div class="users-grid">
                        {% for user in results %}
                            <div class="user-card">
                                <img src="{{ user.avatar_url }}" alt="{{ user.username }}" class="user-avatar-large">
                                <h3><a href="{{ url_for('user_profile', username=user.username) }}">{{ user.username }}</a></h3>
                                <p class="user-karma">üí∞ {{ user.karma }}</p>
                                <p class="user-bio">{{ user.bio[:100] }}</p>
                                {% if current_user.is_authenticated and current_user.id != user.id %}
                                    <a href="{{ url_for('user_profile', username=user.username) }}" class="btn btn-secondary">–ü–µ—Ä–µ–π—Ç–∏</a>
                                {% endif %}
                            </div>
                        {% endfor %}
                    </div>
                
                {% else %}
                    <div class="subreddits-grid">
                        {% for subreddit in results %}
                            <div class="subreddit-card">
                                <h3><a href="{{ url_for('view_subreddit', subreddit_name=subreddit.name) }}">r/{{ subreddit.name }}</a></h3>
                                <p class="subreddit-title">{{ subreddit.title }}</p>
                                <p class="subreddit-members">{{ subreddit.member_count }} –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤</p>
                                <a href="{{ url_for('view_subreddit', subreddit_name=subreddit.name) }}" class="btn btn-secondary">–ü–æ—Å–µ—Ç–∏—Ç—å</a>
                            </div>
                        {% endfor %}
                    </div>
                {% endif %}
            {% else %}
                <p class="empty-state">–ù–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</p>
            {% endif %}
        </div>
    {% endif %}
</div>
{% endblock %}
