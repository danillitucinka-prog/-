{% extends "base.html" %}

{% block title %}r/{{ subreddit.name }} - Beer Field{% endblock %}

{% block content %}
<div class="subreddit-container">
    <div class="subreddit-header">
        {% if subreddit.banner_url %}
            <img src="{{ subreddit.banner_url }}" alt="{{ subreddit.name }}" class="subreddit-banner">
        {% endif %}
        
        <div class="subreddit-info">
            {% if subreddit.icon_url %}
                <img src="{{ subreddit.icon_url }}" alt="{{ subreddit.name }}" class="subreddit-icon">
            {% endif %}
            
            <div class="subreddit-header-text">
                <h1>r/{{ subreddit.name }}</h1>
                <p class="subreddit-title">{{ subreddit.title }}</p>
                <p class="subreddit-description">{{ subreddit.description }}</p>
                
                <div class="subreddit-stats">
                    <span class="stat">üë• {{ subreddit.member_count }} –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤</span>
                    <span class="stat">üìù {{ subreddit.posts|length }} –ø–æ—Å—Ç–æ–≤</span>
                </div>
                
                {% if current_user.is_authenticated %}
                    {% if current_user.is_in_community(subreddit) %}
                        <form method="POST" action="{{ url_for('leave_subreddit', subreddit_name=subreddit.name) }}" style="display: inline;">
                            <button class="btn btn-secondary">–í—ã—Ö–æ–¥</button>
                        </form>
                    {% else %}
                        <form method="POST" action="{{ url_for('join_subreddit', subreddit_name=subreddit.name) }}" style="display: inline;">
                            <button class="btn btn-primary">–ü—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è</button>
                        </form>
                    {% endif %}
                    
                    {% if subreddit.moderator_id == current_user.id %}
                        <a href="{{ url_for('edit_subreddit', subreddit_name=subreddit.name) }}" class="btn btn-secondary">–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ</a>
                    {% endif %}
                {% endif %}
            </div>
        </div>
    </div>
    
    {% if subreddit.rules %}
        <div class="subreddit-rules">
            <h3>–ü—Ä–∞–≤–∏–ª–∞ —Å–æ–æ–±—â–µ—Å—Ç–≤–∞</h3>
            <div class="rules-content">{{ subreddit.rules }}</div>
        </div>
    {% endif %}
    
    <div class="sort-bar">
        <a href="{{ url_for('view_subreddit', subreddit_name=subreddit.name, sort='hot') }}" class="sort-link {% if sort == 'hot' %}active{% endif %}">üî• –ì–æ—Ä—è—á–µ–µ</a>
        <a href="{{ url_for('view_subreddit', subreddit_name=subreddit.name, sort='new') }}" class="sort-link {% if sort == 'new' %}active{% endif %}">‚ú® –ù–æ–≤–æ–µ</a>
        <a href="{{ url_for('view_subreddit', subreddit_name=subreddit.name, sort='top') }}" class="sort-link {% if sort == 'top' %}active{% endif %}">üèÜ –¢–æ–ø</a>
    </div>
    
    {% if posts.items %}
        <div class="posts-list">
            {% for post in posts.items %}
                {% include "posts/post_item.html" %}
            {% endfor %}
        </div>
    {% else %}
        <p class="empty-state">–í —ç—Ç–æ–º —Å–æ–æ–±—â–µ—Å—Ç–≤–µ –µ—â–µ –Ω–µ—Ç –ø–æ—Å—Ç–æ–≤</p>
    {% endif %}
</div>
{% endblock %}
